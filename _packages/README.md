# Debian packages
## Quickstart
[`installed_debs.txt`](installed_debs.txt) lists user-installed Debian packages, generated by [precommit_hook.sh](precommit_hook.sh).  

The script is to be run from the base of this repo.

## Why?
When I was setting up a new machine, I wanted a listing of packages that I had personally installed on my old machine. There are various ways to do this ([1](https://stackoverflow.com/questions/41007182/debian-listing-all-user-installed-packages), [2](https://askubuntu.com/questions/2389/how-to-list-manually-installed-packages)), but the ones I tried included many packages I didn't actually install myself, such as `gnome-user-docs-de` and `sysvinit-utils`.

## Initial install list
Most of the false-positives came about from the original install of the Linux distribution, [Pop!_OS](https://pop.system76.com/). To avoid this problem for my new machine, I recorded the initial install list[^1] output by [`aptitude`](https://wiki.debian.org/Aptitude)[^2] before installing anything myself, which I can now diff against.

## Keeping [`installed_debs.txt`](installed_debs.txt) up to date
I setup a git pre-commit hook which makes it easy to keep it up to date when comitting to this repository.

Command to setup the hook (run from root of this repo):
```
ln -s ../../_packages/precommit_hook.sh .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit
```

### Demo
![git hook demo](git_hook_demo.gif)

## Installations warranting explanation
Commit messages should provide explanations, but for installs that I know I'll quickly forget the reason for, I have this manually-maintained list:
- inotify-tools: for Phoenix live view through [FileSystem](https://github.com/falood/file_system/blob/acfc8a36b1a1bbb2e64e6451173ed03309812b2c/lib/file_system/backends/fs_inotify.ex#L43)
- libssl-dev: for [ruby-build](https://github.com/rbenv/ruby-build/wiki#troubleshooting) which is used by ruby-asdf under the hood

## Issues
There are two issues which sometimes require me to update the original install list manually:
1. System updates sometimes mark certain packages as manually installed. E.g. `libpop-upgrade-gtk` and `pop-upgrade` were originally marked as autoinstalled but changed to manual. This results in false positives.

2. System updates sometimes mark packages that were previously user-installed as auto-installed. E.g. `kitty` was a manual install by me on Pop 21.04 but became automatically installed on 21.10. This results in false negatives.

If these happen often enough I'll work on a fix.

[^1]: The file I have provided is a very minimal example.
[^2]: I tried out `apt` as well but preferred the default output format of `aptitude`. IIRC aptitude also made it easier to remove certain metapackages.
